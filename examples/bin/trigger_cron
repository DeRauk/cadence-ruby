#!/usr/bin/env ruby
require_relative '../init'

Dir[File.expand_path('../workflows/*.rb', __dir__)].each { |f| require f }

<<<<<<< HEAD
workflow_class_name, *args = ARGV
=======
workflow_class_name, schedule, *args = ARGV
>>>>>>> f681793045224f08a713d36c5b0a619c357a5b42
workflow_class = Object.const_get(workflow_class_name)
workflow_id = SecureRandom.uuid

# Convert integer strings to integers
input = args.map { |arg| Integer(arg) rescue arg }

<<<<<<< HEAD
run_id = Cadence.start_workflow(workflow_class, *input, options: { workflow_id: workflow_id })
=======
run_id = Cadence.schedule_workflow(
  workflow_class,
  schedule,
  *input,
  options: { workflow_id: workflow_id }
)
>>>>>>> f681793045224f08a713d36c5b0a619c357a5b42
Cadence.logger.info "Started workflow: #{run_id} / #{workflow_id}"
